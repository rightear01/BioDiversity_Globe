<script>
    // ...

    let highlightedCountry = null; // Variable to store the currently highlighted country

    // 사용자가 입력한 국가명에 해당하는 다각형을 찾아 높이를 조절하는 함수
    function highlightCountryByName(countryName) {
        const matchingCountry = countries.features.find(d => d.properties.ADMIN.toLowerCase() === countryName.toLowerCase());

        if (matchingCountry) {
            // If a matching country is found, highlight it
            highlightedCountry = matchingCountry; // Store the highlighted country
            world.polygonAltitude(d => d === matchingCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === matchingCountry ? 'steelblue' : colorScale(getVal(d)));
        } else {
            // If no matching country is found, remove the highlight
            highlightedCountry = null; // Reset the highlighted country
            world.polygonAltitude(0.06);
            world.polygonCapColor(feat => colorScale(getVal(feat)));
        }
    }

    // ...

    // 마우스 이벤트가 발생해도 id="countryInput" 변수에 값이 존재한다면 해당 나라를 지속적으로 강조
    document.getElementById('countryInput').addEventListener('mouseover', () => {
        if (highlightedCountry) {
            world.polygonAltitude(d => d === highlightedCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === highlightedCountry ? 'steelblue' : colorScale(getVal(d)));
        }
    });

    document.getElementById('countryInput').addEventListener('mouseout', () => {
        if (highlightedCountry) {
            world.polygonAltitude(d => d === highlightedCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === highlightedCountry ? 'steelblue' : colorScale(getVal(d)));
        }
    });

    // ...


    // 사용자 입력을 받을 input 요소 추가
    //let highlightedCountry = null; // Variable to store the currently highlighted country
    const inputElement = document.getElementById('countryInput');

    // 사용자가 입력한 국가명에 해당하는 다각형을 찾아 높이를 조절하는 함수
    function highlightCountryByName(countryName) {
        const matchingCountry = countries.features.find(d => d.properties.ADMIN.toLowerCase() === countryName.toLowerCase());

        if (matchingCountry) {
            // If a matching country is found, highlight it
            highlightedCountry = matchingCountry; // Store the highlighted country
            world.polygonAltitude(d => d === matchingCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === matchingCountry ? 'steelblue' : colorScale(getVal(d)));
        } else {
            // If no matching country is found, remove the highlight
            highlightedCountry = null; // Reset the highlighted country
            world.polygonAltitude(0.06);
            world.polygonCapColor(feat => colorScale(getVal(feat)));
        }
    }
    // 마우스 이벤트가 발생해도 id="countryInput" 변수에 값이 존재한다면 해당 나라를 지속적으로 강조
    document.getElementById('countryInput').addEventListener('mouseover', () => {
        if (highlightedCountry) {
            world.polygonAltitude(d => d === highlightedCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === highlightedCountry ? 'steelblue' : colorScale(getVal(d)));
        }
    });

    document.getElementById('countryInput').addEventListener('mouseout', () => {
        if (highlightedCountry) {
            world.polygonAltitude(d => d === highlightedCountry ? 0.12 : 0.06);
            world.polygonCapColor(d => d === highlightedCountry ? 'steelblue' : colorScale(getVal(d)));
        }
    });

    // 입력값이 변경될 때마다 호출되는 이벤트 리스너 추가
    inputElement.addEventListener('input', (event) => {
        const userInput = event.target.value;
        console.log(userInput);
        console.log(highlightedCountry);
        if (userInput.trim() === '') {
            // 검색 문자열이 없을 때 초기 설정으로 돌아감
            world.polygonAltitude(0.06);
            world.polygonCapColor(feat => colorScale(getVal(feat)));
        } else {
            // 검색 문자열이 있을 때 해당 국가 강조
            highlightCountryByName(userInput);
        }
    });
</script>